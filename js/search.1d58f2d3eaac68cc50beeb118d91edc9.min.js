const removeMarkdown=(c,b={listUnicodeChar:!1,stripListLeaders:!0,gfm:!0,useImgAltText:!1,preserveLinks:!1})=>{let a=c||'';a=a.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*$/gm,'');try{b.stripListLeaders&&(b.listUnicodeChar?a=a.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,b.listUnicodeChar+' $1'):a=a.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,'$1')),b.gfm&&(a=a.replace(/\n={2,}/g,'\n').replace(/~{3}.*\n/g,'').replace(/~~/g,'').replace(/`{3}.*\n/g,'')),b.preserveLinks&&(a=a.replace(/\[(.*?)\][\[\(](.*?)[\]\)]/g,'$1 ($2)')),a=a.replace(/<[^>]*>/g,'').replace(/^[=\-]{2,}\s*$/g,'').replace(/\[\^.+?\](\: .*?$)?/g,'').replace(/(#{1,6})\s+(.+)\1?/g,'<b>$2</b>').replace(/\s{0,2}\[.*?\]: .*?$/g,'').replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,b.useImgAltText?'$1':'').replace(/\[(.*?)\][\[\(].*?[\]\)]/g,'<a>$1</a>').replace(/!?\[\[\S[^\[\]\|]*(?:\|([^\[\]]*))?\S\]\]/g,'<a>$1</a>').replace(/^\s{0,3}>\s?/g,'').replace(/(^|\n)\s{0,3}>\s?/g,'\n\n').replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,'').replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,'$2').replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,'$2').replace(/(`{3,})(.*?)\1/gm,'$2').replace(/`(.+?)`/g,'$1').replace(/\n{2,}/g,'\n\n')}catch(a){return console.error(a),c}return a},highlight=(a,c)=>{const b=20,e=a.indexOf(c);if(e!==-1){const d=b/2,f=a.substring(0,e).split(" ").slice(-d),g=a.substring(e+c.length,a.length-1).split(" ").slice(0,d);return(f.length==d?`...${f.join(" ")}`:f.join(" "))+`<span class="search-highlight">${c}</span>`+g.join(" ")}const l=c.split(/\s+/).filter(a=>a!==''),d=a.split(/\s+/).filter(a=>a!==''),g=a=>l.some(b=>a.toLowerCase().startsWith(b.toLowerCase())),h=d.map(g);let i=0,j=0;for(let a=0;a<Math.max(h.length-b,0);a++){const d=h.slice(a,a+b),c=d.reduce((a,b)=>a+b,0);c>=i&&(i=c,j=a)}const f=Math.max(j-b,0),k=Math.min(f+2*b,d.length),m=d.slice(f,k).map(a=>g(a)?`<span class="search-highlight">${a}</span>`:a).join(' ').replaceAll('</span> <span class="search-highlight">',' ');return`${f===0?'':'...'}${m}${k===d.length?'':'...'}`};(async function(){const h=a=>a.toLowerCase().split(/([^a-z]|[^\x00-\x7F])+/),j=new FlexSearch.Document({cache:!0,charset:'latin:extra',optimize:!0,index:[{field:'content',tokenize:'reverse',encode:h},{field:'title',tokenize:'forward',encode:h}]}),{content:d}=await fetchData;for(const[b,a]of Object.entries(d))j.add({id:b,title:a.title,content:removeMarkdown(a.content)});const m=({url:b,title:c,content:d,term:a})=>{const e=removeMarkdown(d),f=highlight(c,a),g=highlight(e,a);return`<button class="result-card" id="${b}">
        <h3>${f}</h3>
        <p>${g}</p>
    </button>`},i=(a,b)=>{window.Million.navigate(new URL(`${BASE_URL.replace(/\/$/g,"")}${a}#:~:text=${encodeURIComponent(b)}/`),'.singlePage'),e()},l=a=>({id:a,url:a,title:d[a].title,content:d[a].content}),c=document.getElementById('search-bar'),g=document.getElementById('results-container');let b;c.addEventListener('keyup',a=>{if(a.key==='Enter'){const a=document.getElementsByClassName('result-card')[0];i(a.id,b)}}),c.addEventListener('input',d=>{b=d.target.value;const e=j.search(b,[{field:'content',limit:10},{field:'title',limit:5}]),a=b=>{const a=e.filter(a=>a.field===b);return a.length===0?[]:[...a[0].result]},f=new Set([...a('title'),...a('content')]),c=[...f].map(l);if(c.length===0)g.innerHTML=`<button class="result-card">
                    <h3>No results.</h3>
                    <p>Try another search term?</p>
                </button>`;else{g.innerHTML=c.map(a=>m({...a,term:b})).join('\n');const a=[...document.getElementsByClassName('result-card')];a.forEach(a=>{a.onclick=()=>i(a.id,b)})}});const a=document.getElementById('search-container');function f(){a.style.display==='none'||a.style.display===''?(c.value='',g.innerHTML='',a.style.display='block',c.focus()):a.style.display='none'}function e(){a.style.display='none'}document.addEventListener('keydown',a=>{a.key==='k'&&(a.ctrlKey||a.metaKey)&&(a.preventDefault(),f()),a.key==='Escape'&&(a.preventDefault(),e())});const k=document.getElementById('search-icon');k.addEventListener('click',a=>{f()}),k.addEventListener('keydown',a=>{f()}),a.addEventListener('click',a=>{e()}),document.getElementById('search-space').addEventListener('click',a=>{a.stopPropagation()})})()