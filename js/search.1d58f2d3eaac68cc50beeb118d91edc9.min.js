const removeMarkdown=(e,t={listUnicodeChar:!1,stripListLeaders:!0,gfm:!0,useImgAltText:!1,preserveLinks:!1})=>{let n=e||"";n=n.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*$/gm,"");try{t.stripListLeaders&&(t.listUnicodeChar?n=n.replace(/^([\s\t]*)([*\-+]|\d+\.)\s+/gm,t.listUnicodeChar+" $1"):n=n.replace(/^([\s\t]*)([*\-+]|\d+\.)\s+/gm,"$1")),t.gfm&&(n=n.replace(/\n={2,}/g,`
`).replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),t.preserveLinks&&(n=n.replace(/\[(.*?)\][[(](.*?)[\])]/g,"$1 ($2)")),n=n.replace(/<[^>]*>/g,"").replace(/^[=-]{2,}\s*$/g,"").replace(/\[\^.+?\](: .*?$)?/g,"").replace(/(#{1,6})\s+(.+)\1?/g,"<b>$2</b>").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/!\[(.*?)\][[(].*?[\])]/g,t.useImgAltText?"$1":"").replace(/\[(.*?)\][[(].*?[\])]/g,"<a>$1</a>").replace(/!?\[\[\S[^[\]|]*(?:\|([^[\]]*))?\S\]\]/g,"<a>$1</a>").replace(/^\s{0,3}>\s?/g,"").replace(/(^|\n)\s{0,3}>\s?/g,`

`).replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/([*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/([*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/\n{2,}/g,`

`)}catch(t){return console.error(t),e}return n},highlight=(e,t)=>{const n=20,o=e.indexOf(t);if(o!==-1){const s=n/2,i=e.substring(0,o).split(" ").slice(-s),a=e.substring(o+t.length,e.length-1).split(" ").slice(0,s);return(i.length==s?`...${i.join(" ")}`:i.join(" "))+`<span class="search-highlight">${t}</span>`+a.join(" ")}const u=t.split(/\s+/).filter(e=>e!==""),s=e.split(/\s+/).filter(e=>e!==""),a=e=>u.some(t=>e.toLowerCase().startsWith(t.toLowerCase())),r=s.map(a);let c=0,l=0;for(let e=0;e<Math.max(r.length-n,0);e++){const s=r.slice(e,e+n),t=s.reduce((e,t)=>e+t,0);t>=c&&(c=t,l=e)}const i=Math.max(l-n,0),d=Math.min(i+2*n,s.length),h=s.slice(i,d).map(e=>a(e)?`<span class="search-highlight">${e}</span>`:e).join(" ").replaceAll('</span> <span class="search-highlight">'," ");return`${i===0?"":"..."}${h}${d===s.length?"":"..."}`};(async function(){const r=e=>e.toLowerCase().split(/([^a-z]|[^\x00-\x7F])+/),l=new FlexSearch.Document({cache:!0,charset:"latin:extra",optimize:!0,index:[{field:"content",tokenize:"reverse",encode:r},{field:"title",tokenize:"forward",encode:r}]}),{content:s}=await fetchData;for(const[t,e]of Object.entries(s))l.add({id:t,title:e.title,content:removeMarkdown(e.content)});const h=({url:e,title:t,content:n,term:s})=>{const o=removeMarkdown(n),i=highlight(t,s),a=highlight(o,s);return`<button class="result-card" id="${e}">
        <h3>${i}</h3>
        <p>${a}</p>
    </button>`},c=(e,t)=>{window.Million.navigate(new URL(`${BASE_URL.replace(/\/$/g,"")}${e}#:~:text=${encodeURIComponent(t)}/`),".singlePage"),o()},u=e=>({id:e,url:e,title:s[e].title,content:s[e].content}),n=document.getElementById("search-bar"),a=document.getElementById("results-container");let t;n.addEventListener("keyup",e=>{if(e.key==="Enter"){const e=document.getElementsByClassName("result-card")[0];c(e.id,t)}}),n.addEventListener("input",e=>{t=e.target.value;const o=l.search(t,[{field:"content",limit:10},{field:"title",limit:5}]),n=e=>{const t=o.filter(t=>t.field===e);return t.length===0?[]:[...t[0].result]},i=new Set([...n("title"),...n("content")]),s=[...i].map(u);if(s.length===0)a.innerHTML=`<button class="result-card">
                    <h3>No results.</h3>
                    <p>Try another search term?</p>
                </button>`;else{a.innerHTML=s.map(e=>h({...e,term:t})).join(`
`);const e=[...document.getElementsByClassName("result-card")];e.forEach(e=>{e.onclick=()=>c(e.id,t)})}});const e=document.getElementById("search-container");function i(){e.style.display==="none"||e.style.display===""?(n.value="",a.innerHTML="",e.style.display="block",n.focus()):e.style.display="none"}function o(){e.style.display="none"}document.addEventListener("keydown",e=>{e.key==="k"&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),i()),e.key==="Escape"&&(e.preventDefault(),o())});const d=document.getElementById("search-icon");d.addEventListener("click",e=>{i()}),d.addEventListener("keydown",e=>{i()}),e.addEventListener("click",e=>{o()}),document.getElementById("search-space").addEventListener("click",e=>{e.stopPropagation()})})()